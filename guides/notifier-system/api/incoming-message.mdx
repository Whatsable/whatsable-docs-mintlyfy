---
title: 'Incoming Messages'
description: 'Receive and manage real-time WhatsApp message notifications via webhooks'
icon: 'inbox'
---

<Tip>
Incoming message webhooks deliver real-time notifications when your recipients reply, enabling immediate responses and interactive conversations through WhatsApp.
</Tip>

The Incoming Messages system provides a robust webhook infrastructure that enables your application to receive and process WhatsApp messages from your recipients in real-time. This guide covers how to configure, manage, and handle incoming message webhooks.

## Overview

Webhooks are HTTP callbacks that deliver notifications to your server whenever specific events occur - in this case, when recipients reply to your WhatsApp messages. Benefits include:

- **Real-time processing** of customer responses
- **Seamless integration** with your existing systems
- **Automated workflows** triggered by customer messages
- **Enhanced customer experience** through timely interactions

<Card title="Try it in the API Reference" icon="arrow-right" href="https://docs.whatsable.app/api-reference/notifier-system/webhooks/manage-webhooks">
  Explore the Webhook Management API and start receiving incoming messages
</Card>

## Webhook Configuration

### Managing Endpoints

<Steps>
  <Step title="Access Webhook Settings">
    Navigate to the Developer section in your dashboard sidebar to manage webhook configurations.
  </Step>
  <Step title="Configure Endpoint">
    Add a new webhook URL where you want to receive incoming message notifications.
  </Step>
</Steps>

### Endpoint Requirements

<Warning>
All webhook endpoints must be publicly accessible via HTTPS and configured to accept POST requests with JSON payloads. HTTP endpoints are not supported in production environments.
</Warning>

Your webhook endpoint must:

1. Accept HTTP POST requests
2. Process JSON payloads
3. Return a 2xx status code within 10 seconds
4. Implement idempotency handling (see best practices below)

## Webhook Payload

When a user replies to your WhatsApp message, we'll send a POST request to your configured endpoint with a detailed payload.

### Sample Payload

<CodeGroup>
```json Incoming Text Message
{
  "last_messages": [
    {
      "type": "user",
      "content": "Thank you for the quick response. Can you provide more details about your premium service plans?",
      "timestamp": "2025-06-09T22:08:11.990Z",
      "content_type": "text"
    },
    {
      "type": "bot",
      "content": "I'd be happy to help you explore our premium service options. Let me connect you with a specialist who can provide detailed information.",
      "timestamp": "2025-06-09T21:45:30.417Z",
      "content_type": "text"
    }
  ],
  "conversation_paragraph": "User (10:08:11 PM): Thank you for the quick response. Can you provide more details about your premium service plans? ; Bot (9:45:30 PM): I'd be happy to help you explore our premium service options. Let me connect you with a specialist who can provide detailed information.",
  "phone_number": "14155552671",
  "recipient_name": "Sarah Johnson",
  "user_id": "9232fcef-a570-4a2c-b46b-6cab53aec304",
  "last_message_of_user": "Thank you for the quick response. Can you provide more details about your premium service plans?",
  "last_message_of_bot": "I'd be happy to help you explore our premium service options. Let me connect you with a specialist who can provide detailed information.",
  "message_type": "text",
  "user_last_message_time": 1749506891,
  "bot_last_message_time": 1749504330,
  "attachment_url": null,
  "note": "",
  "note_automation": "",
  "labels": "sales, premium-inquiry"
}
```

```json Incoming Media Message
{
  "last_messages": [
    {
      "type": "user",
      "content": "",
      "timestamp": "2025-06-09T14:05:12.000Z",
      "content_type": "document",
      "media_url": "https://api.insightssystem.com/vault/LSMumRx1/VR-1aHOci6nP28eHWHJH7JauJkc/Ew7R9w../contract_proposal_v2.pdf"
    },
    {
      "type": "bot",
      "content": "Please upload the signed contract document when ready, and I'll process it immediately.",
      "timestamp": "2025-06-09T14:03:20.000Z",
      "content_type": "text"
    }
  ],
  "conversation_paragraph": "User (2:05:12 PM): [Document] ; Bot (2:03:20 PM): Please upload the signed contract document when ready, and I'll process it immediately.",
  "phone_number": "14155552671",
  "recipient_name": "Sarah Johnson",
  "user_id": "9232fcef-a570-4a2c-b46b-6cab53aec304",
  "last_message_of_user": "",
  "last_message_of_bot": "Please upload the signed contract document when ready, and I'll process it immediately.",
  "message_type": "document",
  "user_last_message_time": 1749472312,
  "bot_last_message_time": 1749472200,
  "attachment_url": "https://api.insightssystem.com/vault/LSMumRx1/VR-1aHOci6nP28eHWHJH7JauJkc/Ew7R9w../contract_proposal_v2.pdf",
  "note": "",
  "note_automation": "",
  "labels": "contracts, document-processing"
}
```
</CodeGroup>

### Payload Fields

<ResponseField name="last_messages" type="array" required>
  Array containing the recent messages in the conversation
  <Expandable title="last_messages array">
    <ResponseField name="type" type="string" required>
      Sender type ("user" or "bot")
    </ResponseField>

    <ResponseField name="content" type="string">
      Message content (empty for media messages)
    </ResponseField>

    <ResponseField name="timestamp" type="string" required>
      ISO 8601 timestamp when the message was sent
    </ResponseField>

    <ResponseField name="content_type" type="string" required>
      Type of content (text, image, audio, video, document, location)
    </ResponseField>

    <ResponseField name="media_url" type="string">
      URL to media file if applicable (valid for 24 hours)
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="conversation_paragraph" type="string" required>
  Human-readable summary of the recent conversation
</ResponseField>

<ResponseField name="phone_number" type="string" required>
  The phone number of the recipient who sent the message
</ResponseField>

<ResponseField name="recipient_name" type="string">
  The name of the recipient if available
</ResponseField>

<ResponseField name="user_id" type="string" required>
  Unique identifier for the user in your system
</ResponseField>

<ResponseField name="last_message_of_user" type="string">
  The last message sent by the user
</ResponseField>

<ResponseField name="last_message_of_bot" type="string">
  The last message sent by your system
</ResponseField>

<ResponseField name="message_type" type="string" required>
  The type of the latest message (text, image, audio, video, document, location)
</ResponseField>

<ResponseField name="user_last_message_time" type="integer" required>
  Unix timestamp of the user's last message
</ResponseField>

<ResponseField name="bot_last_message_time" type="integer" required>
  Unix timestamp of your system's last message
</ResponseField>

<ResponseField name="attachment_url" type="string">
  URL to media file if the latest message contains media (null for text messages)
</ResponseField>

<ResponseField name="note" type="string">
  Custom note field for additional context
</ResponseField>

<ResponseField name="note_automation" type="string">
  Automation-related notes
</ResponseField>

<ResponseField name="labels" type="string">
  Comma-separated labels for categorizing the conversation
</ResponseField>

## Webhook Management API

You can programmatically manage your webhook endpoints using our API.

### Create Webhook Endpoint

Register a new webhook endpoint to receive incoming message notifications.

<CodeGroup>
```bash cURL
curl -X POST \
  https://api.insightssystem.com/api:qh9OQ3OW/webhook/dev/create \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer YOUR_API_KEY' \
  -d '{
    "url": "https://your-domain.com/api/webhooks/whatsapp"
  }'
```

```javascript Node.js
const axios = require('axios');

async function createWebhook() {
  try {
    const response = await axios.post(
      'https://api.insightssystem.com/api:qh9OQ3OW/webhook/dev/create',
      {
        url: "https://your-domain.com/api/webhooks/whatsapp"
      },
      {
        headers: {
          'Content-Type': 'application/json',
          'Authorization': 'Bearer YOUR_API_KEY'
        }
      }
    );
    console.log(response.data);
    return response.data;
  } catch (error) {
    console.error('Error creating webhook:', error);
  }
}

createWebhook();
```

```python Python
import requests

url = "https://api.insightssystem.com/api:qh9OQ3OW/webhook/dev/create"

headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer YOUR_API_KEY"
}

data = {
    "url": "https://your-domain.com/api/webhooks/whatsapp"
}

response = requests.post(url, headers=headers, json=data)
print(response.json())
```
</CodeGroup>

<Warning>
Always verify webhook signatures to ensure the authenticity of incoming requests. This prevents malicious actors from sending fraudulent events to your endpoint.
</Warning>

## Troubleshooting

<AccordionGroup>
  <Accordion title="Webhook Not Receiving Events" defaultOpen={true}>
    - Verify your endpoint is publicly accessible
    - Check for HTTP 4xx or 5xx responses
    - Ensure proper SSL certificate configuration
    - Verify your webhook is enabled in the dashboard
  </Accordion>
</AccordionGroup>

## FAQs

<AccordionGroup>
  <Accordion title="Can I receive notifications for all WhatsApp account events?">
    Currently, webhooks are available for incoming messages only. We're working on expanding support for additional event types like delivery receipts, read receipts, and account status changes.
  </Accordion>
  <Accordion title="How do I handle different message types?">
    Check the `message_type` field in the webhook payload to determine the message type (text, image, audio, video, document, location) and process accordingly.
  </Accordion>
  <Accordion title="Do I need to respond to every webhook request?">
    Yes, your endpoint must respond with a 2xx HTTP status code for every webhook request to acknowledge receipt. This prevents unnecessary retries.
  </Accordion>
  <Accordion title="How can I test webhook delivery?">
    Use the "Test Webhook" feature in the Developer section of your dashboard to send a sample webhook payload to your endpoint.
  </Accordion>
</AccordionGroup>

<Card title="Need assistance?" icon="headset" href="mailto:support@whatsable.app">
  Our technical support team is available to assist with webhook configuration, payload handling, and integration questions
</Card>